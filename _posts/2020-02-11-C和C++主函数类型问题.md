---
title: C/C++主函数类型问题
date: 2020-02-11 14:52:22
categories:
 - C
 - C++
tags: 
 - C
 - C++
---



很多市面上的一些书籍，都使用了`void main( )`，

其实这是**错误**的。



C/C++ 中**从来没有**定义过`void main( ) `。



**C++ 之父** Bjarne Stroustrup 在他的主页上的 FAQ 中明确地写着 

<u>The definition void main( ) { /* ... */ } is not and never has been C++, nor has it even been C.</u>

*（` void main( )` 从来就不存在于 C++ 或者 C ）*。



------



下面分别说一下 C 和 C++ 标准中对 main 函数的定义。  



1. # C  在 C89 中，main( ) 是可以接受的。

   Brian W. Kernighan 和 Dennis M. Ritchie 的经典巨著 The C programming Language 2e（《C 程序设计语言第二版》）用的就是 `main( )`。

   不过在最新的 **C99** 标准中，只有以下两种定义方式是正确的：  

   `int main( void )  `

   和

   `int main( int argc, char *argv[] ) `

   *（参考资料：ISO/IEC 9899:1999 (E) Programming languages — C 5.1.2.2.1 Program startup）*

     

   当然，我们也可以做一点小小的改动。例如：

   `char *argv[] `

   可以写成

   ` char **argv`；

   <u>argv</u> 和 <u>argc</u> 可以改成别的变量名（如 intval 和 charval），不过一定要符合变量的命名规则。  

   

   如果**不需要**从命令行中获取参数，请用

   `int main(void) `；

   **否则**请用

   `int main( int argc, char *argv[] ) `。 

   

    **main 函数的返回值类型必须是 int** ，这样返回值才能传递给程序的激活者（如操作系统）。  如果 main 函数的**最后没有写 return 语句**的话，**C99** 规定编译器要**自动**在生成的目标文件中（如 exe 文件）**加入return 0**; ，表示程序**正常退出**。

   

   不过，我还是建议你**最好在main函数的最后加上return 语句**，虽然没有这个必要，但这是一个好的习惯。**注意**，**vc6不会**在目标文件中**加入return 0**; ，大概是因为 vc6 是 98 年的产品，所以才不支持这个特性。现在明白我为什么建议你最好加上 return 语句了吧！不过，gcc3.2（Linux 下的 C 编译器）会在生成的目标文件中加入 return 0; 。  

   

2. # C++  C++98 中定义了如下两种 main 函数的定义方式

   `int main( ) `

   和

   ` int main( int argc, char *argv[] ) `

   *（参考资料：ISO/IEC 14882(1998-9-01)Programming languages — C++ 3.6 Start and termination）*  

   

   `int main( ) `等同于 **C99** 中的 `int main( void ) `；

   `int main( int argc, char *argv[] ) `的用法也和 **C99** 中定义的一样。

   同样，**main 函数的返回值类型也必须是int**。如果main函数的末尾没写return语句，**C++98 规定**编译器要**自动**在生成的目标文件中**加入 return 0**; 。同样，**vc6 也不支持这个特性**，但是 g++3.2（Linux 下的 C++ 编译器）支持。  

   

3. # 在 C 和 C++ 中，**不接收任何参数**也**不返回任何信息**的函数原型为`void foo(void)`。

   可能正是因为这个，所以很多人都误认为如果不需要程序返回值时可以把main函数定义成`void main(void) `。

   

   **然而这是错误的！**

   

   **main 函数的返回值应该定义为 int 类型**，**C 和 C++ 标准**中都是这样**规定**的。

   虽然在一些编译器中，`void main `可以通过编译（如 vc6），但**并非所有**编译器都支持 `void main`，**因为标准中从来没有定义过` void main`** 。

   

   **g++3.2** 中如果 main 函数的返回值**不是 int** 类型，就根本**通不过编译**。

   而 **gcc3.2** 则会发出警告。

   

   所以，如果你想你的程序拥有很好的可移植性，请**一定要用` int main`**。  

   

4. # 返回值的作用 : main 函数的返回值用于说明程序的退出状态。

     如果**返回 0**，则代表程序**正常退出**，**否则**代表程序**异常退出**。

  

  

------

  

*版权声明：本文为CSDN博主「starzeng」的原创文章，遵循 CC 4.0 BY-SA 版权协议。*

  *原文链接：https://blog.csdn.net/starzeng/article/details/2527667*